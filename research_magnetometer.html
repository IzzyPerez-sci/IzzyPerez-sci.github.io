<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Izzy Perez – Magnetometer</title>

  <style>
    body{margin:0;background:black;color:white;font-family:"Century Gothic",CenturyGothic,AppleGothic,sans-serif}

    #header{padding:30px;border-bottom:2px solid white;font-size:40px;font-weight:700;letter-spacing:2px;background:black}

    #nav{display:flex;gap:10px;padding:10px 20px;border-bottom:2px solid white;background:black;flex-wrap:wrap}
    .nav-btn{border:2px solid white;padding:10px 20px;font-size:20px;text-decoration:none;color:white;background:black;transition:.3s}
    .nav-btn:hover{background:#222}
    .current{color:yellow!important;border-color:yellow!important}

    #main{background-image:url("research_background.jpg");background-size:cover;background-position:center;padding:40px 20px;min-height:85vh;display:flex;justify-content:center}
    .text-box{background:rgba(0,0,0,.75);padding:30px;border:1px solid #444;max-width:900px;width:100%}

    .page-title{text-align:center;font-size:56px;font-weight:700;letter-spacing:3px;margin:10px 0 30px}
    .section{margin-top:45px;padding-top:35px;border-top:1px solid #444}
    .section h2{font-size:34px;margin:0 0 12px}
    .section p{font-size:22px;line-height:1.6;margin:0 0 18px}
    .mini-title{font-size:22px;font-weight:700;margin:22px 0 10px}
    .media{width:100%;border:1px solid #444;margin-top:14px}

    .yellow-link{color:yellow;text-decoration:none}
    .yellow-link:hover{text-decoration:underline}

    ul{margin:10px 0 0 20px}
    li{margin:8px 0;font-size:20px;line-height:1.5}

    .download-box{border:1px solid #444;padding:16px;margin-top:14px;background:rgba(0,0,0,.35)}
    .download-box p{font-size:20px;margin:10px 0 0}

    /* Graph carousel */
    .carousel{
      position:relative;
      width:100%;
      margin-top:14px;
    }
    .carousel img{
      width:100%;
      border:1px solid #444;
      display:block;
    }
    .carousel .arrow-btn{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      background:rgba(0,0,0,.6);
      border:1px solid #666;
      color:white;
      font-size:26px;
      padding:10px 14px;
      cursor:pointer;
      transition:.2s;
      user-select:none;
    }
    .carousel .arrow-btn:hover{background:#222}
    .carousel .left{left:10px}
    .carousel .right{right:10px}

    .carousel-dots{
      display:flex;
      justify-content:center;
      gap:10px;
      margin-top:10px;
    }
    .dot{
      width:10px;
      height:10px;
      border-radius:50%;
      background:#666;
      cursor:pointer;
    }
    .dot.active{background:yellow}
  </style>
</head>

<body>

  <div id="header">IZZY PEREZ</div>

  <div id="nav">
    <a class="nav-btn" href="index.html">About Me</a>
    <a class="nav-btn current" href="research.html">Research</a>
    <a class="nav-btn" href="writing.html">Science Writing</a>
    <a class="nav-btn" href="coding.html">Coding</a>
    <a class="nav-btn" href="creative.html">Creative/Art</a>
  </div>

  <div id="main">
    <div class="text-box">

      <h1 class="page-title">Solar-Powered 3-Axis Magnetometer</h1>

      <!-- Goals and Background -->
      <div class="section">
        <h2>Goals and Background</h2>

        <p>
          The goal of this project is to design a magnetometer system that is cost-effective, solar-powered,
          and suitable for long-duration outdoor deployment.
        </p>

        <p>
          Earth’s magnetic field originates in the molten outer core and extends into the magnetosphere, where it shields Earth
          from the solar wind. Interactions with the solar wind produce magnetic field variations ranging from quiet daily
          variations of a few tens of nanoteslas, to substorms producing ~10–100 nT disturbances, and larger geomagnetic storms
          that can exceed 100 nT.
        </p>

        <p>
          It is difficult and expensive to acquire magnetometers designed for long-term monitoring of Earth’s magnetic field variations.
          While magnetometers are commercially available, many are wired, stationary, and not designed for autonomous data collection.
        </p>

        <div class="mini-title">System Requirements</div>

        <embed src="research_magnetometer_system-requirements.pdf" type="application/pdf" width="100%" height="500px" class="media">

        <p style="margin-top:14px;font-size:18px;">
          <a class="yellow-link" href="research_magnetometer_system-requirements.pdf" target="_blank">Open PDF in new tab →</a>
        </p>
      </div>

      <!-- Electronics -->
      <div class="section">
        <h2>Electronics</h2>

        <p>
          The instrument is powered by rechargeable LiFePO4 batteries, charged either through a solar panel regulated by a solar
          charge controller or via a micro-USB connection to the Raspberry Pi Pico 2W.
        </p>

        <p>
          A Raspberry Pi Pico 2W communicates with the MMC5983MA magnetometer over I²C to acquire three-axis magnetic field
          measurements. Measurement data are written locally from the Pico to a SD card for long-term storage.
        </p>

        <div class="mini-title">Wiring diagram</div>
        <img src="research_magnetometer_wiring-diagram.png" class="media" alt="Magnetometer wiring diagram">

        <div class="mini-title">Components</div>
        <ul>
          <li><b>3-axis magnetometer sensor:</b> measures X, Y, Z field components</li>
          <li><b>Microcontroller:</b> triggers measurements, timestamps, and controls logging</li>
          <li><b>SD card module:</b> stores long runs locally as text files</li>
          <li><b>Power system:</b> solar panel, charge controller, LiFePO4 battery</li>
        </ul>
      </div>

      <!-- Housing -->
      <div class="section">
        <h2>Housing</h2>

        <p>
          The mechanical design was optimized to be compact, weatherproof, and to separate the magnetometer from other electronics
          to reduce interference.
        </p>

        <p>
          The enclosure consists of three parts: an upper mount for the sensor, a lower mount for the batteries and electronics,
          and an outer housing. The mounts slide into the housing and are oriented to allow easy access to the Pico’s micro-USB
          port and SD card.
        </p>

        <p>
          The design minimizes print time and material usage, requiring 142 g of filament and approximately 9.9 hours to print.
        </p>

        <div class="mini-title">Housing Design</div>
        <img src="research_magnetomter_housing.png" class="media" alt="Housing design">

        <div class="mini-title">Download STEP files</div>
        <p style="font-size:20px;line-height:1.6;margin:0;">
          <a class="yellow-link" href="magnetometer_housing.step" download>Download housing STEP →</a>
        </p>
      </div>

      <!-- Software -->
      <div class="section">
        <h2>Software</h2>

        <p>
          The instrument runs MicroPython to read the sensor, timestamp and log data to the SD card,
          and support wireless access.
        </p>

        <p>
          A custom driver was written in MicroPython for the Raspberry Pi Pico 2W to control the MMC5983MA magnetometer over I²C,
          trigger magnetic and temperature measurements, apply periodic SET/RESET, and timestamp data using the Pico’s millisecond
          clock. Measurements are averaged and then logged to an SD card using an SD card breakout board over SPI.
        </p>

        <div class="download-box">
          <div class="mini-title" style="margin:0 0 8px;">Download code</div>
          <p><a class="yellow-link" href="research_magnetomter_main-code.py" download>Download Code→</a></p>
        </div>
      </div>

      <!-- Website -->
      <div class="section">
        <h2>Website</h2>

        <p>
          The Pico 2W hosts a WiFi access point and runs a web server that allows users to connect directly to the instrument by
          entering its IP address in a browser. The website displays a live graph of the three magnetic field components and allows
          users to download data.
        </p>

        <img src="magnetometer_website_preview.png" class="media" alt="Magnetometer website preview">
      </div>

      <!-- Results -->
      <div class="section">
        <h2>Current Results</h2>

        <!-- Graph Carousel -->
        <div class="carousel">
          <button class="arrow-btn left" id="graph-left">&#10094;</button>
          <img id="graph-slideshow" src="research_magnetometer_graph1.png" alt="Magnetometer field test graph">
          <button class="arrow-btn right" id="graph-right">&#10095;</button>
        </div>

        <div class="carousel-dots" id="graph-dots"></div>

        <p style="margin-top:18px;">
          Three long-term deployments have been conducted so far. The first two revealed a drifting Y measurement, which was
          caused by sensor drift. To address this, I implemented the sensor’s SET/RESET capability, which switches the orientation of
          the sensing element. The third test shows that this SET/RESET prevented sensor drift. The instrument was slightly bumped in the
          middle of the third test, but overall was very flat. A long term test is currently underway to hopefully pick up any variations
          due to geomagnetic activity.
        </p>
      </div>

    </div>
  </div>

  <!-- Graph Carousel Script -->
  <script>
    const graphPhotos = [
      "research_magnetometer_graph1.png",
      "research_magnetometer_graph2.png",
      "research_magnetometer_graph3.png"
    ];

    let graphIndex = 0;

    const graphImg = document.getElementById("graph-slideshow");
    const graphLeft = document.getElementById("graph-left");
    const graphRight = document.getElementById("graph-right");
    const dotsContainer = document.getElementById("graph-dots");

    function renderDots(){
      dotsContainer.innerHTML = "";
      for(let i = 0; i < graphPhotos.length; i++){
        const d = document.createElement("div");
        d.className = "dot" + (i === graphIndex ? " active" : "");
        d.addEventListener("click", () => {
          graphIndex = i;
          graphImg.src = graphPhotos[graphIndex];
          renderDots();
        });
        dotsContainer.appendChild(d);
      }
    }

    graphRight.addEventListener("click", () => {
      graphIndex = (graphIndex + 1) % graphPhotos.length;
      graphImg.src = graphPhotos[graphIndex];
      renderDots();
    });

    graphLeft.addEventListener("click", () => {
      graphIndex = (graphIndex - 1 + graphPhotos.length) % graphPhotos.length;
      graphImg.src = graphPhotos[graphIndex];
      renderDots();
    });

    renderDots();
  </script>

</body>
</html>

